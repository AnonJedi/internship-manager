extends ./layout.jade

block container
  .container
    h4.mt-5.mb-4
      | Пользователи
    div
      form(action="/admin/users", method="POST", type="form")
        input(type="hidden", name="_csrf", value="#{csrf}")

        h4
          | Новый пользователь

        .form-group
          label(for="username-new")
            | имя пользователя
          input(id="username-new", class="form-control", type="text", name="username", required)
        

        .form-group
          label(for="email-new")
            | email
          input(id="email-new", class="form-control", type="text", name="email", required)
        

        .form-group
          label(for="password-new")
            | пароль
          input(id="password-new", class="form-control", type="text", name="password", required)
          
        .form-group
          label(for="role-new")
            | роль
          select(id="role-new", class="form-control", name="role", required)
            option(value="0")
              | админ
            option(value="1")
              | пользователь
        
        input(type="submit", class="btn btn-primary", value="Создать пользователя")
        
      if flash
        div
          | #{flash[0].message}
    hr
    
    each user in users
      div
        form(action="/admin/users/#{user.id}", method="POST", type="form")
          input(type="hidden", name="_csrf", value="#{csrf}")
          input(type="hidden", name="action", value="PUT")

          .form-group
            label(for="username-#{user.id}")
              | имя пользователя
            input(id="username-#{user.id}", class="form-control", type="text", value="#{user.username}", name="username", required)

          .form-group
            label(for="email-#{user.id}")
              | email
            input(id="email-#{user.id}", class="form-control", type="email", value="#{user.email}", name="email", required)

          .form-group
            label(for="password-#{user.id}")
              | пароль
            input(id="password-#{user.id}", class="form-control", type="text", name="password")

          .form-group
            label(for="role-#{user.id}")
              | роль
            select(id="role-#{user.id}", class="form-control", name="role", required)
              option(value="0", selected=user.role == 0)
                | админ
              option(value="1", selected=user.role == 1)
                | пользователь
          input(type="submit", class="btn btn-primary", value="Сохранить")

        form(action="/admin/users/#{user.id}", method="POST", type="form")
          input(type="hidden", name="_csrf", value="#{csrf}")
          input(type="hidden", name="action", value="DELETE")
          input(type="submit", class="btn btn-danger" value="Удалить")
        
        hr

        
